-- x age
--   fix pan
-- x hush x1

import Light

lightServer
l1 <- lightStream

x1 $ jux rev $ weave 16 (n (run 8) # s "arpy")
  [vowel "a e i",
   vowel "i o [u e]",
   speed "1 2 ~ 3"
   ]
  # dur "0.03"

x1 $ sound "bd8:4*3 cp [sn:2 wobble*2] "

cps 0.7

x2 $ (chop 32 $ jux (iter 4) $ sound "[bd*16 sn*8,cp8:3*3]")
  #nudge (slow 4 sine1)



hush

x1 $ s "bd*5"

hush

x1 $ slow 4 $ jux rev $ striate 32 $ s "sn" # n "51"
  # dur "0.1"

x1 $ jux (iter 4) $ sound "bd8 cp sn:8*3" # dur "0.2"

stringToColour' "cp8"
x1 $ sound "cp"
x1 $ chop 8 $ jux rev $ s "cp bd cp bd*3"

x1 silence

l1 $ s "orange*8" # pan (slow 4 sine1)
l1 silence
l1 $ s "red green" # pan "0"

l1 $ s (p "{purple pink, orange blue green}" :: Pattern ColourD)
l1 $ rgb "x"
c2rgb red

l1 silence
l1 $ red "[0 0.1]*16" # green (slow 2 saw1) # blue (slow 4 sine1)
  
l1 $ red "0"

x1 $ sound "bd 0 0 0"

output <- SP.openSerial "/dev/ttyUSB0" SP.defaultSerialSettings
let to256 f = show $ floor (f * 255)

SP.send output $ B.pack $ "r\r"

l1 $ red "0.5*8"

lightServer

let to256 f = show $ floor (f * 255)

